@page
@model MyApp.EasyAuth.Pages.LogoutModel

@{
    ViewData["Title"] = "Logging out...";
}

<div class="text-center">
    <h1>Logging you out...</h1>
    <p>Please wait while we sign you out of the application.</p>
    <div class="spinner-border text-primary mt-3" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>

<script>
    // Submit the form automatically when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        // Clear local storage and session storage
        localStorage.clear();
        sessionStorage.clear();
        
        // Clear all cookies that might be related to authentication
        document.cookie.split(';').forEach(function(c) {
            document.cookie = c.trim().split('=')[0] + '=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;';
        });
        
        // Add cache-busting parameter to prevent browser from using cached state
        const cacheBuster = new Date().getTime();
        // Automatically trigger server-side logout with cache busting
        window.location.href = `?handler=&t=${cacheBuster}`;
    });
</script>